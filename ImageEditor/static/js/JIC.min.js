var jic={compress:function(t,e,a){var n="image/jpeg";"undefined"!=typeof a&&"png"==a&&(n="image/png");var r=document.createElement("canvas");r.width=t.naturalWidth,r.height=t.naturalHeight;var o=(r.getContext("2d").drawImage(t,0,0),r.toDataURL(n,e/100)),i=new Image;return i.src=o,i},upload:function(t,e,a,n,r,o,i,s){var u=document.createElement("canvas");u.width=t.naturalWidth,u.height=t.naturalHeight;u.getContext("2d").drawImage(t,0,0);void 0===XMLHttpRequest.prototype.sendAsBinary&&(XMLHttpRequest.prototype.sendAsBinary=function(t){var e=Array.prototype.map.call(t,function(t){return 255&t.charCodeAt(0)});this.send(new Uint8Array(e).buffer)});var d="image/jpeg";".png"==n.substr(-4)&&(d="image/png");var p=u.toDataURL(d);p=p.replace("data:"+d+";base64,","");var c=new XMLHttpRequest;c.open("POST",e,!0);var g="someboundary";if(c.setRequestHeader("Content-Type","multipart/form-data; boundary="+g),s&&"object"==typeof s)for(var m in s)c.setRequestHeader(m,s[m]);i&&i instanceof Function&&(c.onprogress=function(t){return t.lengthComputable?t.loaded/t.total*100:void 0}),c.sendAsBinary(["--"+g,'Content-Disposition: form-data; name="'+a+'"; filename="'+n+'"',"Content-Type: "+d,"",atob(p),"--"+g+"--"].join("\r\n")),c.onreadystatechange=function(){4==this.readyState&&(200==this.status?r(this.responseText):this.status>=400&&o&&o instanceof Function&&o(this.responseText))}}};